#!/usr/bin/env bash

##############################################
#	Author: Nidia Achrys
#	Project: extract
#	Version: 1.0
#
#	Usage: extract [command] [args]
#
#	Description:
#		Extract any archive file
##############################################

version='1.0'
author='Nidia Achrys'

# Source common script functions
source $SCRIPTS/01-api.sh

#############
# Core Code #
#############

DEPENDENCY "tar"
DEPENDENCY "bunzip"
DEPENDENCY "unrar"
DEPENDENCY "gunzip"
DEPENDENCY "unzip"
DEPENDENCY "uncompress"
DEPENDENCY "7z"
DEPENDENCY "ar"
DEPENDENCY "unzstd"

if [ -f "$1" ]
then
	case "$1" in
        	*.tar.bz2)    tar xjf $1    ;;
        	*.tar.gz)     tar xzf $1    ;;
        	*.bz2)        bunzip $1     ;;
        	*.rar)        unrar x $1    ;;
        	*.gz)         gunzip $1     ;;
        	*.tar)        tar xf $1     ;;
        	*.tbz2)       tar xjf $1    ;;
        	*.tgz)        tar xzf $1    ;;
        	*.zip)        unzip $1      ;;
        	*.Z)          uncompress $1 ;;
        	*.7z)         7z x $1       ;;
        	*.deb)        ar x $1       ;;
        	*.tar.xz)     tar xf $1     ;;
        	*.tar.zst)    unzstd $1     ;;
        	*)            PRINT "'${1}' cannot be extracted via ${SCRIPTNAME}" ;;
	esac
elif [ "${1}" = "--help" ]
then
	PRINT "usage: ${SCRIPTNAME} <file>\n"
	PRINT "supported file types:"
	PRINT "tar.bz2, tar.gz, bz2, rar, gz, tar, tbz2, tgz"
	PRINT "zip, Z, 7z, deb, tar.xz, tar.zst"
elif [ -z "${1}" ]
then
	PRINT "You need to specify an archive to extract."
else
	PRINT "'${1}' is not a valid archive."
fi
